<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Playground - Book API</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { --primary: #00d2ff; --secondary: #0066ff; --dark-bg: #030712; --sidebar-w: 280px; --glass-bg: rgba(15, 23, 42, 0.75); --border: rgba(255, 255, 255, 0.15); }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: linear-gradient(to bottom, rgba(3, 7, 18, 0.8), rgba(3, 7, 18, 0.95)), url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?auto=format&fit=crop&q=80&w=2000'); background-size: cover; background-attachment: fixed; color: #ffffff; min-height: 100vh; margin: 0; overflow-x: hidden; }
        
        /* FIX: Tambahkan overflow-x hidden pada layout dashboard */
        .dashboard-layout { display: flex; width: 100%; overflow-x: hidden; }

        /* FIX: Batasi lebar konten agar tidak melar kesamping */
        .main-content { 
            margin-left: var(--sidebar-w); 
            flex: 1; 
            padding: 50px 60px; 
            max-width: 1400px; 
        }

        .page-header h2 { font-weight: 800; font-size: 2.5rem; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .glass-card { background: var(--glass-bg); backdrop-filter: blur(25px); border: 1px solid var(--border); border-radius: 30px; padding: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .input-label { font-size: 0.75rem; font-weight: 900; color: var(--primary); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px; display: block; }
        .form-control-custom { background: rgba(255,255,255,0.05); border: 1.5px solid var(--border); color: #fff; padding: 14px 18px; border-radius: 15px; font-weight: 700; transition: 0.3s; }
        .form-control-custom:focus { border-color: var(--primary); background: rgba(255,255,255,0.1); outline: none; box-shadow: none; }
        .btn-send { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: #000; border: none; font-weight: 900; padding: 18px; border-radius: 16px; width: 100%; transition: 0.3s; box-shadow: 0 10px 20px rgba(0, 210, 255, 0.4); text-transform: uppercase; }
        .btn-send:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(0, 210, 255, 0.6); }
        .response-json { background: #0d1117; border-radius: 20px; padding: 25px; color: #c9d1d9; font-family: 'Fira Code', monospace; border: 1px solid var(--border); max-height: 500px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="dashboard-layout"><div id="navbar-container"></div>
        <main class="main-content">
            <header class="page-header mb-5"><h5 class="text-primary fw-bold mb-2"><i class="fas fa-flask-vial me-2"></i>ENVIRONMENT UJI COBA</h5><h2>API Playground</h2><p class="text-white-50">Lakukan simulasi permintaan API untuk memvalidasi data aplikasi Anda.</p></header>
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="glass-card">
                        <div class="mb-4"><span class="input-label">1. Auth Key</span><input type="text" id="playApiKey" class="form-control-custom w-100" placeholder="sk_..."></div>
                        <div class="mb-4"><span class="input-label">2. Endpoint Target</span><select id="playEndpoint" class="form-control-custom w-100"><option value="/api/books">GET /api/books (Katalog Buku)</option><option value="/api/categories">GET /api/categories (Kategori)</option></select></div>
                        <div class="mb-4"><span class="input-label">3. Parameter Pencarian</span><input type="text" id="playSearch" class="form-control-custom w-100" placeholder="Cari judul/penulis..."></div>
                        <button onclick="runTest()" id="btnSend" class="btn btn-send">Kirim Request <i class="fas fa-paper-plane ms-2"></i></button>
                        <!-- TOMBOL VISUAL EXPLORER -->
                        <button onclick="goToExplorer()" class="btn btn-outline-info w-100 mt-3 py-3 fw-bold" style="border-radius:15px; border-width:2px; color:var(--primary); border-color:var(--primary);">
                            <i class="fas fa-images me-2"></i>BUKA VISUAL EXPLORER
                        </button>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="d-flex justify-content-between align-items-center mb-3"><div class="badge bg-white bg-opacity-10 px-3 py-2 border rounded-pill">Status: <span id="resStatus">-</span></div></div>
                    <div class="glass-card" style="min-height: 500px;">
                        <pre id="jsonContent" class="response-json">Klik "Kirim Request" untuk memproses data JSON...</pre>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="navbar.js"></script>
    <script>
        initNavbar('playground');
        const currentKey = localStorage.getItem('book_api_key'); 
        if (currentKey) document.getElementById('playApiKey').value = currentKey;

        function goToExplorer() {
            const endpoint = document.getElementById('playEndpoint').value;
            const search = document.getElementById('playSearch').value.trim();
            window.location.href = `explorer.html?endpoint=${encodeURIComponent(endpoint)}&search=${encodeURIComponent(search)}`;
        }

        async function runTest() {
            const key = document.getElementById('playApiKey').value;
            let endpoint = document.getElementById('playEndpoint').value;
            const searchVal = document.getElementById('playSearch').value.trim();
            const btnSend = document.getElementById('btnSend');
            if (!key) return Swal.fire('Error', 'API Key wajib diisi!', 'warning');
            if (searchVal) endpoint += `?search=${encodeURIComponent(searchVal)}`;
            btnSend.disabled = true;
            btnSend.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i>';
            try {
                const res = await fetch(endpoint, { headers: { 'x-api-key': key } });
                const result = await res.json();
                document.getElementById('resStatus').innerText = `${res.status} ${res.statusText}`;
                document.getElementById('jsonContent').textContent = JSON.stringify(result, null, 2);
                if(res.ok) {
                    Swal.fire({ title: 'Request Berhasil!', text: 'Lihat tampilan Gallery?', icon: 'success', showCancelButton: true, confirmButtonText: 'Buka Explorer', background: '#0f172a', color: '#fff' })
                    .then((r) => { if(r.isConfirmed) goToExplorer(); });
                }
            } catch (err) { Swal.fire('Gagal', 'Terjadi kesalahan koneksi.', 'error'); }
            finally { btnSend.disabled = false; btnSend.innerHTML = 'Kirim Request <i class="fas fa-paper-plane ms-2"></i>'; }
        }
    </script>
</body>
</html>